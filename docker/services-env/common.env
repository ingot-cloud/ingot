# ==========================================
# Ingot Cloud 公共环境变量配置
# 适用于所有微服务
# ==========================================

# ==================== Spring Boot配置 ====================
SHUTDOWN_TIMEOUT=30s

# ==================== 数据库配置 ====================
MYSQL_HOST=mysql-db
MYSQL_PORT=3306
MYSQL_USERNAME=dev
MYSQL_PASSWORD=123456
MYSQL_SSL=false

# MySQL性能优化参数
MYSQL_PREP_STMT_CACHE_SIZE=250
MYSQL_PREP_STMT_SQL_LIMIT=2048
MYSQL_SOCKET_TIMEOUT=30000
MYSQL_CONNECT_TIMEOUT=10000

# 数据库连接池配置（Druid）
DB_POOL_INITIAL_SIZE=5
DB_POOL_MIN_IDLE=5
DB_POOL_MAX_ACTIVE=80
DB_POOL_MAX_WAIT=5000

# 数据库连接泄露检测
DB_REMOVE_ABANDONED=true
DB_REMOVE_ABANDONED_TIMEOUT=300
DB_LOG_ABANDONED=true

# 慢SQL阈值（毫秒）
DB_SLOW_SQL_MILLIS=2000

# SQL超时配置（秒）
DB_QUERY_TIMEOUT=30
DB_TX_QUERY_TIMEOUT=60

# 数据库Keep Alive
DB_KEEP_ALIVE=true

# Druid监控配置
DRUID_STAT_VIEW_ENABLED=true
DRUID_WEB_STAT_ENABLED=true
DRUID_USERNAME=admin
DRUID_PASSWORD=DruidAdmin@2024
DRUID_ALLOW=127.0.0.1,192.168.0.0/16,172.16.0.0/12,10.0.0.0/8
DRUID_DENY=

# 生产环境SQL防火墙
DB_WALL_CREATE_TABLE=false
DB_WALL_DROP_TABLE=false
DB_WALL_ALTER_TABLE=false
DB_WALL_TRUNCATE=false
DB_FILTERS=stat,wall

# ==================== Redis配置 ====================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DATABASE=0
REDIS_PASSWORD=ingotredis
REDIS_TIMEOUT=3000
REDIS_SSL_ENABLED=false

# Redis连接池配置（Lettuce）
REDIS_POOL_MAX_ACTIVE=50
REDIS_POOL_MAX_IDLE=20
REDIS_POOL_MIN_IDLE=5
REDIS_POOL_MAX_WAIT=3000

# ==================== Nacos配置 ====================
# 支持单节点或集群（用逗号分隔）
# 单节点: localhost:8848
# 集群: nacos1:8848,nacos2:8848,nacos3:8848
NACOS_SERVER_ADDR=nacos1:8848,nacos2:8848,nacos3:8848
NACOS_NAMESPACE=ingot
NACOS_GROUP=PROD_GROUP
NACOS_USERNAME=nacos
NACOS_PASSWORD=nacos

# ==================== Sentinel配置 ====================
SENTINEL_LOG_DIR=/ingot-data/sentinel/

# ==================== Feign配置 ====================
FEIGN_CONNECT_TIMEOUT=5000
FEIGN_READ_TIMEOUT=10000
FEIGN_LOGGER_LEVEL=BASIC
FEIGN_SENTINEL_ENABLED=true
FEIGN_MAX_CONNECTIONS=400
FEIGN_MAX_CONNECTIONS_PER_ROUTE=50

# ==================== 日志配置 ====================
LOG_PATH=/ingot-data/logs
LOG_LEVEL_ROOT=WARN
LOG_LEVEL_WEB=WARN
LOG_LEVEL_SECURITY=WARN
LOG_LEVEL_CLOUD=WARN
LOG_LEVEL_NACOS=ERROR
LOG_LEVEL_APP=INFO

# 日志文件大小和保留策略
LOG_FILE_MAX_SIZE=100MB
LOG_FILE_MAX_HISTORY=30
LOG_FILE_TOTAL_SIZE=20GB

# ==================== MyBatis/MyBatis-Plus配置 ====================
MYBATIS_CACHE_ENABLED=true
MYBATIS_LAZY_LOADING=true
MYBATIS_STATEMENT_TIMEOUT=30
MYBATIS_PLUS_ID_TYPE=ASSIGN_ID
MYBATIS_PLUS_PERFORMANCE=false
MYBATIS_SHOW_SQL=false

# ==================== 业务配置 ====================
# Jasypt加密密钥（必填，强烈建议更换）
JASYPT_PASSWORD=ingot

# 加密密钥（必填，强烈建议更换为32位随机字符串）
CRYPTO_AES_KEY=ingotingotingot1
CRYPTO_AES_GCM_KEY=ingotingotingot1

# MinIO配置
MINIO_URL=http://minio:9000
MINIO_ACCESS_KEY=2NPpKzxFQjyeMTQFEXA1
MINIO_SECRET_KEY=8SGAp7DhqZCQrYnU9Poyu888pQOB6w4SP2ILHbVU

# ==================== 文件上传配置 ====================
MAX_FILE_SIZE=100MB
MAX_REQUEST_SIZE=100MB

# ==================== 监控端点配置 ====================
MANAGEMENT_ENDPOINTS=health,info,metrics
HEALTH_SHOW_DETAILS=ALWAYS
HEALTH_DISK_THRESHOLD=10GB

